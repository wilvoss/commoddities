Vue.config.devtools=!1,Vue.config.debug=!1,Vue.config.silent=!0,Vue.config.ignoredElements=["app","page","navbar","settings","splash","splashwrap","message","notifications","speedControls","state","bank","commodity","detail","gameover","listheader","listings","category","name","units","currentPrice","description","market","currentValue","contractSize","goldbacking","contractUnit"];var app=new Vue({el:"#app",data:{showNotification:!1,notificationType:[{serious:"serious",normal:"normal",warn:"warn"}],currentNotification:null,commodityData:[],dataColumns:9,pages:[new PageObject({name:"Market",isSelected:!0,isDisabled:!1}),new PageObject({name:"Quest"}),new PageObject({name:"Log",isShown:!1})],showColor:!0,sortByPrice:!1,sortByReversePrice:!1,sortByUnitsOwned:!1,sortByValue:!1,commodities:[],totalValue:0,startValue:0,gamePaused:!1,gameLoaded:!1,startingBank:100,currentBank:0,bankInterval:null,bankAddCount:0,bankFundsAdded:!1,selectedCommodity:null,displayedCommodity:new CommodityObject({}),feeUnit:.01,halfFee:0,fullFee:0,timeToEnd:(UseDebug,365),gameOver:!1,gameInterval:null,ringleaderinterval:null,gameSpeed:1e4,giftList:[],giftEarned:!1,tipSpeed:500,tipFee:6,tipEngaged:!1,currentTip:"",tipTexts:Tips,currentTipText:"",tipHistory:[],tipTimer:0,tipTimerLimit:100,tippedCommodity:void 0,hasBeenFined:!1,showSEC:!1,sortByWatched:!1,isSerious:!1,showSettings:!1,showTutorial:!1,tutorials:Tutorials,currentTutorial:new TutorialObject({}),sparklineLength:10,detailHistoryLength:34,showHowTo:!1,themes:Themes,currentTheme:Themes[2],useTheLightness:!1,watchedItemCount:0,muteAudio:!0,changeEveryDay:!1,moods:["volatile","normal","stable"],r:document.querySelector(":root"),c:window.getComputedStyle(document.querySelector(":root"))},methods:{AssignCommidityData(){var t="",e=0;for(let i=0;i<Commoddities.length;i++){let s=Commoddities[i],o=new CommodityObject({name:s.name,key:s.key,description:s.description,category:s.category,imageUrl:s.imageUrl,currentPrice:new PriceObject({value:.04+Number(s.rarity)*getRandomInt(s.rarity,10*s.rarity)/100}),volatility:this.moods[getRandomInt(0,3)],rarity:s.rarity});if(o.priceHistory.push(o.currentPrice),o.category!=t){let t=new CommodityObject({name:"",category:o.category,isHeader:!0,key:"cat"+e++,rarity:o.rarity});this.commodities.push(t)}t=o.category,this.commodities.push(o)}this.GetTotalGamerMarketValue(),this.GenerateGiftList();let i=this.changeEveryDay?30:200;for(let t=0;t<i;t++)this.UpdateGame(!1)},StartTutorial(){this.showTutorial=!0,this.currentTutorial=this.tutorials[0],this.StartOver()},AdvanceTutorial(){for(let t=0;t<this.tutorials.length;t++){if(this.tutorials[t]==this.currentTutorial&&t!=this.tutorials.length-1){this.currentTutorial=this.tutorials[t+1];break}t==this.tutorials.length-1&&this.EndTutorial()}},EndTutorial(){this.StartOver();let t=new TutorialObject(this.currentTutorial);t.position="-200px",this.currentTutorial=t,this.showTutorial=!1},Add10ToBank(){this.bankFundsAdded=!0,window.clearInterval(this.bankInterval)},UpdateTipTimer(){!this.gamePaused&&this.tipTimer<this.tipTimerLimit&&this.tipTimer++},CreateNotification(t,e,i,s,o,a="",r=null){let n=new NotificationObject({title:e,subtitle:i,type:t,button1Text:s,button1CallBack:o,button2Text:a,button2CallBack:r});this.currentNotification=n},HandleQuitGameCall(){this.CreateNotification("serious","Are you sure you want to quit?","","No",this.CloseNotification,"Yes",this.EndGame),this.ShowNotification()},HandleInsiderTradingCall(){this.tipFee=(this.currentBank+this.totalValue)/4,this.tipTimer==this.tipTimerLimit&&this.gameLoaded&&null==this.tippedCommodity&&this.timeToEnd>10&&!this.gamePaused&&!this.showNotification&&(this.CreateNotification("normal","Want an inside trader's tip for "+this.Currency(this.tipFee)+"?","","I Accept!",this.EngageTip,"Close",this.CloseNotification),this.ShowNotification(),this.tipTimer=0)},ShowNotification(){this.showNotification=!0,this.ToggleGamePaused(!0)},CloseNotification(){this.showNotification=!1,this.showSEC=!1,this.ToggleGamePaused(!1)},ToggleGamePaused(t){0!=this.timeToEnd&&(window.clearInterval(this.gameInterval),this.gamePaused=null==t?!this.gamePaused:t,this.gamePaused||(this.gameInterval=window.setInterval(this.UpdateGame,this.gameSpeed)))},MathTheFee(t){if(0!=this.displayedCommodity.currentPrice.value){if("half"==t){var e=this.currentBank/2-Number(this.currentBank/2%this.displayedCommodity.currentPrice.value),i=Math.floor(e/this.displayedCommodity.currentPrice.value);return this.halfFee=i*this.feeUnit,i*this.displayedCommodity.currentPrice.value}e=this.currentBank-Number(this.currentBank%this.displayedCommodity.currentPrice.value),i=Math.floor(e/this.displayedCommodity.currentPrice.value);var s=this.fullFee;for(s=i*this.feeUnit;Number(s)+Number(i)*Number(this.displayedCommodity.currentPrice.value)>Number(this.currentBank);)s=--i*this.feeUnit;return this.fullFee=s,i*this.displayedCommodity.currentPrice.value}return 0},TallyCommodityValues(){this.commodities.forEach((t=>{t.currentValue=t.unitsOwned*t.currentPrice.value}))},GetTotalGamerMarketValue(){this.totalValue=0,this.commodities.forEach((t=>{t.isHeader||(this.totalValue+=t.currentValue)}))},GetHighestValueInLastSetForAllComms(){this.commodities.forEach((t=>{if(!t.isHeader){t.highestOutOfLastSet=0;for(let e=t.priceHistory.length-1;e>t.priceHistory.length-this.sparklineLength;e--)if(null!=t.priceHistory[e]&&null!=t.priceHistory[e].value){const i=t.priceHistory[e].value;t.highestOutOfLastSet=i>t.highestOutOfLastSet?i:t.highestOutOfLastSet}}}))},SelectGiftedCommodity(t,e){this.commodities.forEach((i=>{e.name==i.name&&this.SelectCommodity(t,i)}))},SelectCommodity(t,e){null!=t&&(t.preventDefault(),t.stopPropagation()),null==e||e.isHeader||(null!=this.selectedCommodity&&(this.selectedCommodity.isSelected=!1),this.selectedCommodity!=e?(e.isSelected=!0,this.displayedCommodity=e,this.selectedCommodity=e):(e.isSelected=!1,this.selectedCommodity=null),document.getElementsByTagName("detail")[0].scrollTo(0,0))},EngageTip(){this.currentTipText=this.tipTexts[getRandomInt(0,this.tipTexts.length)];let t=getRandomInt(0,this.commodities.length-1);for(;this.commodities[t].isHeader;)t=getRandomInt(0,this.commodities.length-1);this.currentBank=this.currentBank-this.tipFee;let e="up";this.commodities[t].unitsOwned>0&&(e=getRandomInt(0,100)<40?"down":"up"),this.commodities[t].tip=e,this.commodities[t].tipCountDown=getRandomInt(2,11),this.tippedCommodity=this.commodities[t],this.tipEngaged=!0;let i=this.currentTipText.beforeText+this.tippedCommodity.name+this.currentTipText.inBetweenText+this.tippedCommodity.tip+this.currentTipText.afterText;this.CreateNotification(this.notificationType.normal,"Greedy much? Cool!",i,"Close",this.CloseNotification),this.tipHistory.push(this.commodities[t].name)},SelectThisPage(t){this.pages.forEach((t=>{t.isSelected=!1})),t.isSelected=!0},UpdateGame(t=!0){if(!this.gamePaused){this.commodities.forEach((e=>{var i="none"!=e.tip;if(!e.isHeader&&this.timeToEnd>0){if(getRandomInt(0,100)>90||i&&0==e.tipCountDown||this.changeEveryDay){let a=getRandomInt(0,100)>95||i&&0==e.tipCountDown;a=!!t&&a;var s=getRandomInt(0,100)<48?-1:1,o=getRandomInt(0,100)<35?-1:1;switch(e.volatility){case"volatile":s=getRandomInt(0,100)<50?-1:1,o=getRandomInt(0,100)<50?-1:1;break;case"stable":s=getRandomInt(0,100)<85?-1:1,o=getRandomInt(0,100)<15?-1:1;break}let r=e.currentPrice.value<e.previousPrice.value?s:o;i&&0==e.tipCountDown&&(r="up"==e.tip?1:-1,this.tippedCommodity=void 0,e.tip="none");let n=getRandomInt(1,20*(e.currentPrice.value<1?1:e.currentPrice.value))/100,h=getRandomInt(20,75*(e.currentPrice.value<1?1:e.currentPrice.value))/100,m=r*(a?h:n),l=new PriceObject({value:Number(e.currentPrice.value)+m});l.value=Math.round(100*l.value)/100,(5!=getRandomInt(0,100)||a)&&l.value<.01&&(l.value=.01),l.value<0&&(l=new PriceObject({value:0}),e.currentValue=0),l.value=Number(Math.round(100*l.value)/100),e.previousPrice=e.currentPrice,e.currentPrice=l,e.priceHistory.push(e.currentPrice),e.currentPrice.value>e.highestPrice.value&&(e.highestPrice.value=e.currentPrice.value),e.currentValue=Number(e.unitsOwned)*Number(e.currentPrice.value),e.currentValue>0?(e.justChanged=!0,window.setTimeout((function(){e.justChanged=!1}),50)):e.unitsOwned>0&&(this.CreateNotification("warn","Some of your stocks have zeroed out.","Your associated units have been revoked.","Close",this.CloseNotification),this.ShowNotification(),e.unitsOwned=0,e.lostAll=!0)}}})),null!=this.tippedCommodity&&this.tippedCommodity.tipCountDown>0&&(this.tippedCommodity.tipCountDown=this.tippedCommodity.tipCountDown-1);var e=this.hasBeenFined?getRandomInt(0,100):getRandomInt(1,200);this.showSEC=this.tipHistory.length>0&&!this.gameOver&&!this.gamePaused&&e<this.tipHistory.length,this.showSEC&&(this.hasBeenFined=!0,this.tipHistory=[],null!=this.tippedCommodity&&(this.tippedCommodity.tipCountDown=0,this.tippedCommodity.tip="none",this.tippedCommodity=void 0),this.CreateNotification("warn","You are in violation of the Oddity code!","You've been fined half of your stock and half your funds as a result.","It won't happen again!",this.CloseNotification),this.ShowNotification(),this.commodities.forEach((t=>{t.unitsOwned=Math.floor(t.unitsOwned/2)})),this.currentBank=Math.floor(this.currentBank/2)),t&&this.timeToEnd--,this.CheckGiftList(),this.TallyCommodityValues(),this.GetTotalGamerMarketValue(),t&&this.GetHighestValueInLastSetForAllComms();var i=!0;this.commodities.forEach((t=>{t.currentPrice.value+1<this.totalValue+this.currentBank&&0!=t.currentPrice.value&&(i=!1)})),(0===this.timeToEnd||i)&&this.QuitGame()}},HandleQuitGame(){this.isSerious=!0},QuitGame(){this.EndGame()},EndGame(){window.clearInterval(this.gameInterval),null!=this.currentNotification&&"serious"==this.currentNotification.type&&(this.showNotification=!1),this.gameOver=!0,this.displayedCommodity=null,this.selectedCommodity=null,this.showSettings=!1},StartOver(){this.showNotification=!1,this.isSerious=!1,this.gameLoaded=!0,this.gameOver=!1,this.timeToEnd=0,this.sortByPrice=!1,this.sortByValue=!1,this.sortByUnitsOwned=!1,this.sortByReversePrice=!1,this.currentBank=this.startingBank,this.bankFundsAdded=!1,this.gamePaused=!1,this.totalValue=0,this.startValue=0,this.commodities=[],this.timeToEnd=(UseDebug,365),this.gameSpeed=1e4,this.selectedCommodity=null,this.displayedCommodity=new CommodityObject({}),this.tipEngaged=!1,this.tipTimer=0,this.currentTip="",this.tipHistory=[],this.tippedCommodity=void 0,this.showSEC=!1,this.sortByWatched=!1,this.sortByPrice=!1,this.sortByValue=!1,this.sortByUnitsOwned=!1,this.sortByReversePrice=!1,this.AssignCommidityData(),this.GetHighestValueInLastSetForAllComms(),this.gameInterval=window.setInterval(this.UpdateGame,this.gameSpeed),this.bankInterval=window.setInterval(this.Add10ToBank,100)},ToggleGameSpeed(){1e4==this.gameSpeed?this.gameSpeed=5e3:5e3==this.gameSpeed?this.gameSpeed=1e3:1e3==this.gameSpeed&&(this.gameSpeed=1e4),window.clearInterval(this.gameInterval),this.gameInterval=window.setInterval(this.UpdateGame,this.gameSpeed)},ToggleItemAsWatched(t){t.isWatched=!t.isWatched,t.isWatched?this.watchedItemCount++:this.watchedItemCount--},ToggleMusic(){this.muteAudio=!this.muteAudio,localStorage.setItem("muteAudio",this.muteAudio);let t=document.getElementById("themeMusic");t.volume=.05,t.loop=!0,this.muteAudio?t.pause():t.play()},ToggleGamePlay(){this.changeEveryDay=!this.changeEveryDay,localStorage.setItem("changeEveryDay",this.changeEveryDay)},BuyCommodity(t){if("half"==t){var e=this.MathTheFee(t);this.displayedCommodity.unitsOwned=Math.floor(this.displayedCommodity.unitsOwned+e/this.displayedCommodity.currentPrice.value),this.currentBank=this.currentBank-e-this.halfFee}else{var i=this.MathTheFee(t);this.displayedCommodity.unitsOwned=Math.floor(this.displayedCommodity.unitsOwned+i/this.displayedCommodity.currentPrice.value),this.currentBank=this.currentBank-i-this.fullFee}this.displayedCommodity.currentPrice.isPurchasePrice=!0,this.TallyCommodityValues(),this.GetTotalGamerMarketValue(),this.CheckGiftList()},SellAll(){this.commodities.forEach((t=>{this.SellNumberOfUnits(t,"full")})),this.TallyCommodityValues(),this.GetTotalGamerMarketValue(),this.CheckGiftList(),this.totalValue=0},SellNumberOfUnits(t,e){var i="half"==e?Math.floor(t.unitsOwned/2):t.unitsOwned;this.currentBank=this.currentBank+i*t.currentPrice.value,t.unitsOwned=t.unitsOwned-i,t.currentPrice.isSellPrice=!0,this.TallyCommodityValues(),this.GetTotalGamerMarketValue()},ChangeGameColor(t){this.themes.forEach((t=>{t.isSelected=!1})),t.isSelected=!0,localStorage.setItem("theme",t.name),this.r.style.setProperty("--hue",t.hue),this.r.style.setProperty("--saturation",t.saturation+"%"),this.r.style.setProperty("--luminosity",t.luminosity+"%"),null==t.darkAccentColor?this.r.style.setProperty("--accentColor",t.accentColor):this.r.style.setProperty("--accentColor",this.useTheLightness?t.darkAccentColor:t.accentColor),this.currentTheme=t},ChangeGameLuminosity(t){this.useTheLightness=t,localStorage.setItem("useTheLightness",this.useTheLightness),document.getElementById("theLightness").href=this.useTheLightness?"styles/lightness.css":"",this.r.style.setProperty("--accentColor",this.useTheLightness?this.currentTheme.darkAccentColor:this.currentTheme.accentColor)},CheckGiftList(){this.giftList.forEach((t=>{this.commodities.forEach((e=>{e.name==t.name&&(t.unitsOwned=e.unitsOwned,t.giftFulfilled=t.unitsOwned>=100)}))})),!this.giftEarned&&this.giftList[0].unitsOwned>=100&&this.giftList[1].unitsOwned>=100&&this.giftList[2].unitsOwned>=100&&this.giftList[3].unitsOwned>=100&&(this.CreateNotification("normal","You completed the quest!","Congratulations, you are now $20,000 richer.","Close",this.CloseNotification),this.ShowNotification(),this.currentBank=this.currentBank+2e4,this.giftEarned=!0)},GenerateGiftList(){let t=new CommodityObject(this.commodities[getRandomInt(0,this.commodities.length)]);for(;t.isHeader;)t=new CommodityObject(this.commodities[getRandomInt(0,this.commodities.length)]);let e=new CommodityObject(this.commodities[getRandomInt(0,this.commodities.length)]);for(;e.isHeader||e.name==t.name;)e=new CommodityObject(this.commodities[getRandomInt(0,this.commodities.length)]);let i=new CommodityObject(this.commodities[getRandomInt(0,this.commodities.length)]);for(;i.isHeader||i.name==t.name||i.name==e.name;)i=new CommodityObject(this.commodities[getRandomInt(0,this.commodities.length)]);let s=new CommodityObject(this.commodities[getRandomInt(0,this.commodities.length)]);for(;s.isHeader||s.name==t.name||s.name==e.name||s.name==i.name;)s=new CommodityObject(this.commodities[getRandomInt(0,this.commodities.length)]);let o=new CommodityObject(this.commodities[getRandomInt(0,this.commodities.length)]);for(;o.isHeader||o.name==t.name||o.name==e.name||o.name==i.name||o.name==s.name;)o=new CommodityObject(this.commodities[getRandomInt(0,this.commodities.length)]);this.giftList=[t,e,i,s,o]},Currency:t=>Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),FormatAsNumber:t=>Intl.NumberFormat("en-US").format(t),Share(){navigator.share({title:"CommOddities!",text:"Buy, sell, embrace or avoid corruption!",url:"https://commoddities.games"})},RestorePreferences(){let t=localStorage.getItem("theme")?localStorage.getItem("theme"):null;null!=t&&this.themes.forEach((e=>{e.name==t&&this.ChangeGameColor(e)}));let e=localStorage.getItem("useTheLightness")?localStorage.getItem("useTheLightness"):null;null!=e&&this.ChangeGameLuminosity("true"==e);let i=localStorage.getItem("changeEveryDay")?localStorage.getItem("changeEveryDay"):null;null!=i&&(this.changeEveryDay="true"==i),document.getElementById("themeSource").src="audio/CommOdditiesTheme3.aac";let s=localStorage.getItem("muteAudio")?localStorage.getItem("muteAudio"):null;null!=s&&"false"==s&&this.ToggleMusic()}},mounted(){this.RestorePreferences(),this.ringleaderinterval=window.setInterval(this.UpdateTipTimer,this.tipSpeed)},computed:{hasLostAlls:function(){let t=!1;return this.commodities.forEach((e=>{e.lostAll&&(t=!0)})),t},priceHistoryInReverse:function(){return[...this.displayedCommodity.priceHistory].reverse()},commoditiesByName:function(){return this.commodities.sort((function(t,e){return t.rarity<e.rarity?-1:t.rarity>e.rarity?1:t.name<e.name?-1:t.name>e.name?1:0}))},commoditiesValue:function(){return this.commodities.sort((function(t,e){return t.rarity<e.rarity?-1:t.rarity>e.rarity?1:t.currentValue<e.currentValue?-1:t.currentValue>e.currentValue?1:t.name<e.name?-1:t.name>e.name?1:0}))},commoditiesByPrice:function(){return this.commodities.sort((function(t,e){return t.currentPrice.value<e.currentPrice.value?-1:t.currentPrice.value>e.currentPrice.value?1:0}))}}});